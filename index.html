<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My great media player</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <table id="videoTable">
    <thead>
      <tr>
        <th>Video List</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <video id="videoPlayer" controls style="display:none; width: 100%; max-width: 600px;">
    <source id="videoSource" type="video/mp4">
    Your browser does not support the video tag.
  </video>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      fetch('http://localhost:3000/videoList')
        .then(response => response.json())
        .then(data => {
          const tableBody = document.querySelector('#videoTable tbody');
          data.forEach(video => {
            const row = document.createElement('tr');
            const cell = document.createElement('td');
            cell.textContent = video;
            cell.style.cursor = 'pointer';
            cell.onclick = () => {
              playVideo(video);
              setSelectedRow(row);
            };
            row.appendChild(cell);
            tableBody.appendChild(row);
          });
        })
        .catch(error => {
          console.error('Error fetching video list:', error);
        });
    });

    function playVideo(fileName) {
      fetch(`http://localhost:3000/getVideoUrl?fileName=${encodeURIComponent(fileName)}`)
        .then(response => response.json())
        .then(data => {
          const videoPlayer = document.getElementById('videoPlayer');
          const videoSource = document.getElementById('videoSource');
          videoSource.src = data.url;
          videoPlayer.style.display = 'block';
          videoPlayer.load();
          videoPlayer.play();
        })
        .catch(error => {
          console.error('Error fetching video URL:', error);
        });
    }

    function setSelectedRow(selectedRow) {
      const rows = document.querySelectorAll('#videoTable tbody tr');
      rows.forEach(row => row.classList.remove('selected'));
      selectedRow.classList.add('selected');
    }
  </script>
</body>
</html>
